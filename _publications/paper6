---
title: "*Ce modèle vous plaît?* Semi-parametric Bradley--Terry Estimation and Socially Optimal Routing Policies for Large Language Models"
collection: publications
category: progress
permalink: /publication/paper6
excerpt: 'Large language models have become general-purpose inputs in production, decision-making, and public service delivery, creating a need to choose and route among models that differ sharply in both quality and cost. While quality is determined by human preferences over outputs in specific contexts, large-scale inference on frontier models generates substantial private and social costs that deployment decisions rarely internalize. This paper develops an econometric framework that integrates semiparametric inference with large-scale LLM preference evaluation to study heterogeneous model quality, quality–cost tradeoffs, and efficient routing. I introduce a heterogeneity-enriched Bradley–Terry model in which latent preference parameters vary flexibly with prompt embeddings and contextual covariates, allowing fine-grained assessment of performance heterogeneity without ad hoc subsetting or repeated fixed-parameter estimation across prompt sub-populations. Estimation proceeds using the structural deep learning method of \cite{farrell2020deep}, which yields Neyman-orthogonal influence functions and valid inference for nonlinear functionals of the parameter functions. I then combine the estimated preference structure with predicted inference costs to evaluate the social cost of alternative routing policies and to derive optimal rules that preserve expected user-evaluated quality while internalizing environmental impacts. Applying the framework to the French government’s Compar:IA dataset and inference cost measures for 26 widely used LLMs from Ecologits, I document substantial heterogeneity in relative model performance and cost sensitivity across prompt contexts. The resulting social-cost-aware routing policies generate large predicted reductions in emissions and energy use relative to fixed-model or social-cost-blind strategies.'
date: 2025-12-11
paperurl: 'https://spencersween.github.io/files/paper6.pdf'
---


